# 业余无线电考试系统 - 用户认证功能

## 功能概述

系统现已集成完整的用户认证和管理功能，包括：

### 🔐 用户认证
- 手机号+密码登录
- JWT Token认证
- 自动登录状态保持
- 登录过期自动跳转

### 👥 用户管理（管理员功能）
- 添加新用户
- 重置用户密码
- 删除用户
- 用户状态管理

### 🎯 权限控制
- **普通用户**：考试练习、错题本功能
- **管理员**：所有功能 + 用户管理

## 默认账号

```
管理员手机号：17610788168
管理员密码：administrator
```

## 使用说明

### 1. 管理员登录
1. 访问系统首页
2. 使用默认管理员账号登录
3. 登录后可以看到"用户管理"标签页

### 2. 添加用户
1. 管理员登录后，点击"用户管理"标签
2. 点击"添加用户"按钮
3. 输入用户手机号
4. 系统自动生成默认密码：`wxd666a`
5. 将手机号和默认密码告知用户

### 3. 普通用户登录
1. 使用管理员提供的手机号和默认密码登录
2. 首次登录后建议修改密码（联系管理员重置）

### 4. 用户管理操作
- **重置密码**：将用户密码重置为默认值 `wxd666a`
- **删除用户**：永久删除用户（不可恢复）
- **查看用户列表**：显示所有用户信息

## 技术特性

### 安全特性
- 密码SHA256加密存储
- JWT Token认证
- 请求拦截器自动处理认证
- 权限验证装饰器

### 用户体验
- 响应式登录界面
- 实时表单验证
- 友好的错误提示
- 自动token刷新

### 管理功能
- 直观的用户管理界面
- 批量操作支持
- 操作日志记录
- 状态实时更新

## API接口

### 认证相关
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/register` - 添加用户（管理员）
- `POST /api/auth/verify` - 验证Token
- `GET /api/auth/users` - 获取用户列表（管理员）
- `DELETE /api/auth/users/{id}` - 删除用户（管理员）
- `POST /api/auth/reset-password/{id}` - 重置密码（管理员）

### 业务接口（需要认证）
- `GET /api/questions` - 获取题目
- `GET /api/exam` - 生成考试
- `POST /api/exam/submit` - 提交考试
- `GET /api/wrong-questions` - 获取错题
- `POST /api/wrong-questions/practice-submit` - 提交练习

## 部署说明

### 1. 后端部署
```bash
cd /opt/radio-exam/backend
pip3 install -r requirements.txt
sudo systemctl restart radio-exam-backend
```

### 2. 前端部署
```bash
cd /opt/radio-exam/frontend
npm install
npm run build
sudo systemctl restart nginx
```

### 3. 一键部署
```bash
chmod +x deploy-auth.sh
./deploy-auth.sh
```

## 注意事项

1. **首次部署**：系统会自动创建默认管理员账号
2. **密码安全**：建议首次登录后修改默认密码
3. **用户数据**：用户信息存储在 `backend/data/users.json` 文件中
4. **Token有效期**：7天，过期后需要重新登录
5. **权限控制**：所有业务接口都需要登录后才能访问

## 故障排除

### 登录问题
- 检查手机号格式是否正确
- 确认密码是否正确
- 查看浏览器控制台错误信息

### 权限问题
- 确认用户状态是否为"正常"
- 检查管理员权限设置
- 查看后端日志

### 部署问题
- 确认依赖包是否正确安装
- 检查服务启动状态
- 查看Nginx配置文件

## 更新日志

### v2.0.0 (2024-11-27)
- ✨ 新增用户认证功能
- ✨ 新增用户管理功能
- ✨ 新增权限控制系统
- 🔒 所有API接口增加认证保护
- 🎨 优化用户界面和交互体验
- 📱 响应式设计适配移动端